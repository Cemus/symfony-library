name: Test de tests (^^) avec Cypress

on:
  push:
    branches: ["main"]

jobs:
  job:
    name: Message lancé (validation du workflow)
    runs-on: ubuntu-latest
    steps:
      - name: Lance un message
        run: |
          echo "Workflow valide :) !"
          exit 0

  build:
    name: Build et test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Installer dépendances
        run: |
          composer i
          npm i
      - name: Migration
        run: |
          php bin/console make:database
          php bin/console make:migration
          php bin/console d:m:m
      - name: Run Cypress
        run: |
          npm run cypress:run
